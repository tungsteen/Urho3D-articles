# Шейдеры (Shaders) в Urho3D
Эта статья - перевод [статьи] (http://urho3d.github.io/documentation/1.5/_shaders.html) с моими комментариями

Urho3D использует uber-shader подход [1] в котором различные вариации каждого шейдера будут скомпилированы с различными параметрами, чтобы получить различные варианты шейдера, например: статический шейдер или тестурированыый шейдер, ренедринг с задержкой, прямой рендеринг или рендерин с тенью или без.

Компилирование таких шейдеров происходит по запросу: техника (technique) и пути рендеринга (renderpaths) определяют вызов шейдера и задание параметров к нему. В добавок, игровой движок добавит переменные в шейдер, которые связаны с типом геометрии и освещения. Как правило, невозможно зараннее перечислить все возможные варианты, которые будут откомпилированы для шейдера.

В Direct3D полученные после компиляции шейдера байткоды будут сохранены в поддиректорию "Cache" рядом с исходным кодом шейдера. В OpenGL подобного возможности нет.

## Встроенные параметры шейдера

Для ренедринг объекта сцены, игровой движок требует, чтобы определенные варианты шейдера существовали для различных геометрий и условий света. Принаписании шейдера, модно использовать для этой цели следующие параметры:

### Шейдер вершин
- NUMVERTEXLIGHTS=1,2,3 или 4: число освещения падающего на каждую вершину объекта
- DIRLIGHT, SPOTLIGHT, POINTLIGHT: тип освещения падающего на пиксель. Обычно идет в сочетании с PERPIXEL
- SHADOW: направленный на пиксель свет создает тень
- SKINNED, INSTANCED, BILLBOARD: тип геометрии

### Шейдер пикселей

- DIRLIGHT, SPOTLIGHT, POINTLIGHT: тип освещения падающего на пиксель. Обычно идет в сочетании с PERPIXEL
- CUBEMASK: кубическая маска для точечного света
- SPEC: от (specular) отражение для точечного света
- SHADOW: тень для точечного света
- LQSHADOW: тень низкого качества
- SHADOWCMP: сравнение глубины света заданной вручную, в Direct3D9  только для DF16 и DF24 формата теней
- HEIGHTFOG: режим тумана для зоны объект 

## Встроенные общие переменные (uniforms) для шейдеров

Когда объекта или quad-проходы рендерятся, различные встроенные переменные (uniforms) ипсользуются для передачи данных. Далее приведен список переменных для Direct3D HLSL шейдеров. Соответствующие парамтры для GLSL могут быть найдены в файле Uniforms.glsl




## Комментарии
[1] uber-shader подход - создание одного большого шейдера, оторый компилируется несколько раз с различными #define для различных нужд. Например #define USE_NORMAL_MAP будет включать фцнкции нормалей карты, или NUM_SPOTLIGHTS определит сколько исуточников света будет обработано шейдером. Проблема в таком подходе, код становится клубком из различных вызовов функций и становится сложным для поддержки и отладки.

